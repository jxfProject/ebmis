#override("title")
SpringWind - 项目管理
#end
#override("css")
<link href="#springUrl('/static/css/plugins/bootstrap-table/bootstrap-table.min.css')" rel="stylesheet">
#end
#override("breadcrumb")
<li><a>农电商数据报表</a></li><li><a>类别数据</a></li><li class="active"><a>生鲜分类统计</a></li>
#end
#override("content")
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content" style="margin-top: 200px">
            <div id="progressTest" class="progress">
				  <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 100%">
				    请稍等,正在导出中.........
				  </div>
			</div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<button type="button" class="btn btn-primary pull-right" onClick="OutExcel()">导出Excel</button>
<div class="pull-right" style="padding-right:0px">
	<form id="formExcel" class="form-inline">
		<Strong>时间选择:</Strong>
		<select id="ExcelYear" name="ExcelYear" class="form-control">
		</select>
		<span style="font-size: 16px">年</span>
		<select id="ExcelMonth" name="ExcelMonth" class="form-control">
				<option value='请选择'>请选择</option>
				<option value="1">1</option>
				<option value="2">2</option>
				<option value="3">3</option>
				<option value="4">4</option>
				<option value="5">5</option>
				<option value="6">6</option>
				<option value="7">7</option>
				<option value="8">8</option>
				<option value="9">9</option>
				<option value="10">10</option>
				<option value="11">11</option>
				<option value="12">12</option>
		</select>
		<span style="margin-right: 15px;font-size: 16px">月</span>
		<button type="button" class="btn btn-primary" style="margin-right: 300px" onClick="selectForm()">查询</button>		
		<input type="hidden" id="currentIndex" name="_index">
		<input type="hidden" id="currentSize" name="_size">
		<input type="hidden" id="platName" name="platName" value="生鲜分类统计">
		<select id="ExcelValue" name="ExcelValue" class="form-control">
				<option value="1">当前页</option>
				<option value="2">全部</option>
		</select>
	</form>
</div>


<div class="row">
    <div class="col-sm-12">
    	<h3 class="text-center" style="margin-top: 30px"></h3>
        <table id="dataTable"></table>
    </div>
</div>
#end
#override("js")
<script src="#springUrl('/static/js/plugins/bootstrap-table/bootstrap-table.min.js')"></script>
<script src="#springUrl('/static/js/plugins/bootstrap-table/bootstrap-table-mobile.min.js')"></script>
<script src="#springUrl('/static/js/plugins/bootstrap-table/locale/bootstrap-table-zh-CN.min.js')"></script>
<script src="#springUrl('/static/plugins/layer-v2.2/layer/layer.js')"></script>
<script src="#springUrl('/static/js/base_list.js')"></script>
<script src="#springUrl('/static/js/common.js')"></script>
<script type="text/javascript">
   	var date = new Date();
	var currentYear = date.getFullYear();
	$("#ExcelYear").html("<option value='请选择'>请选择</option><option value='"+currentYear+"'>"+currentYear+"</option><option value='"+(currentYear-1)+"'>"+(currentYear-1)+"</option><option value='"+(currentYear-2)+"'>"+(currentYear-2)+"</option><option value='"+(currentYear-3)+"'>"+(currentYear-3)+"</option><option value='"+(currentYear-4)+"'>"+(currentYear-4)+"</option>")
   	var dataUrl = "#springUrl('/allReport/FreshClassifyReport.html?ExcelYear=请选择&ExcelMonth=请选择')";
	function selectForm(){
		var ExcelYearValue=$("#ExcelYear").val();
		var ExcelMonthValue=$("#ExcelMonth").val();
		var opt = {
    	        url: "#springUrl('/allReport/FreshClassifyReport.html?ExcelYear="+ExcelYearValue+"&ExcelMonth="+ExcelMonthValue+"')"
    	    };
    		$("#dataTable").bootstrapTable('refresh', opt);
	}
	$("#ExcelYear").change(function(){
		var ExcelYearValue=$("#ExcelYear").val();
		if(ExcelYearValue=="请选择"){
			$("#ExcelMonth").html("<option value='请选择'>请选择</option><option value='1'>1</option><option value='2'>2</option><option value='3'>3</option><option value='4'>4</option><option value='5'>5</option><option value='6'>6</option><option value='7'>7</option><option value='8'>8</option><option value='9'>9</option><option value='10'>10</option><option value='11'>11</option><option value='12'>12</option>")
		}
	});
    var dataColumns = [{
        field: '一级',
        title: '一级'
    },{
        field: '销售额（万元）',
        title: '销售额（万元）'
    }, {
        field: '销量',
        title: '销量'
    }, {
        field: 'SKU',
        title: 'SKU'
    },{
        field: 'selectTime',
        title: '时间'
    }];
    function dataQueryParams(params) {
    	$("#currentIndex").val(params.offset);
    	$("#currentSize").val(params.limit);
        return {
            _size: params.limit,  //页面大小
            _index: params.offset, //页码
        };
    }
    function OutExcel(){
    	$('#myModal').modal('show');
    	$.ajax({
        	url: "#springUrl('/outExcel/FreshClassifyExcel')",
            data: $("#formExcel").serialize(),
            type: "POST",
            success: function(data){
            	$('#myModal').modal('hide');
            	var d = JSON.parse(data);
            	var info=d.data;
            	layer.alert(info, {
        			  skin: 'layui-layer-molv',
        			  closeBtn: 0
        			});
            }
    	});
    }
</script>
#end
#extends("/common/framework.html")
<script type="text/javascript">
$("#first").removeClass();
$("#third").addClass("active");
$("#thirdLevel2").addClass("active");
</script>
